{% extends "layout.html" %}
{% block content %}
<h1 class="text-center">{{ bill.name }} - Transactions</h1>

<table class="table mt-4 text-center">
    <thead>
        <tr>
            <th scope="col">Transaction Name</th>
            <th scope="col">Amount (USD)</th>
            <th scope="col">Payer</th>
            <th scope="col">Splitters</th>
            <th scope="col">Amount Owed</th>
        </tr>
    </thead>
    <tbody>
        {% for transaction in bill.transactions %}
        <tr>
            <td>{{ transaction.name }}</td>
            <td>{{ "%.2f"|format(transaction.amount) }}</td>
            <td>{{ transaction.payer.name }}</td>
            <td>
                {% for splitter in transaction.splitters %}
                    {{ splitter.name }}<br>
                {% endfor %}
            </td>
            <td id="amount_owed_{{ transaction.id }}">
                <!-- We'll calculate this dynamically using JavaScript -->
                <script>
                    var totalAmount =  transaction.amount ;
                    var numSplitters = transaction.splitters|length ;
                    var amountOwed = (totalAmount / numSplitters).toFixed(2); // Calculate amount per splitter
                    document.getElementById("amount_owed_{{ transaction.id }}").innerHTML = amountOwed;
                </script>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}
